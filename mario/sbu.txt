# 衝突メッセージの設定
            if 'Kuribo' in code:
                if 'Fire Mario' in mario_state['state']:
                    collision_message = (
                        "ファイヤーマリオでクリボーに当たって死亡しました！\n"
                        "ファイヤーマリオなら、ファイアボールを使ってクリボーを倒すことができます。\n"
                        "次は火を使って進むと良いでしょう。5秒前に戻って再挑戦してください！"
                    )
                else:
                    collision_message = (
                        "クリボーにぶつかって死亡しました！\n"
                        "さては落ちついていないですね…\n"
                        "見なかったことにしますので、5秒前に戻って再挑戦しましょう！"
                    )

            # ハンマーブロスにぶつかった場合
            elif 'Hummer Bros' in label:
                if  mario_state['y'] < bros["y"] :  # マリオより上にブロスがいる時
                    collision_message = (
                        "ハンマーブロスのハンマーに当たって死亡しました！\n"
                        "下に通り抜けるチャンスがあります。足元の足場を使って下をくぐったり\n"
                        "また、上の足場を叩いて倒すことも可能です。5秒前に戻って再挑戦！"
                        )
                else:
                    collision_message = (
                        "ハンマーブロスのハンマーに当たって死亡しました！\n"
                        "ハンマーの動きを注意深く見て近づき、ジャンプするタイミングで通り抜けてみましょう\n"
                        "踏みつけて倒すこともできますよ、再挑戦してみてください！"
                    )

            # げっそー（Blooper）の動き
            elif 'Blooper' in label:
                #ゲッソーの判定もできるようにしたかったのですけどね
                # if 'escape' in blooper_state:  # 逃げるタイプのげっそー
                #     collision_message = (
                #         "げっそーにやられました！\n"
                #         "逃げるタイプのげっそーは近づいても問題ありませんが、慎重に進んでください。\n"
                #         "足場があれば、冷静に進みましょう。5秒前に戻って再挑戦してください！"
                #     )
                # elif 'aggressive' in blooper_state:  # 近づいてくるタイプのげっそー
                #     collision_message = (
                #         "げっそーにやられました！\n"
                #         "近づいてくるタイプのげっそーには、逃げられなくなることが多いです。\n"
                #         "そのため、○○秒前に戻って安全な場所を探しながら進みましょう。"
                #     )
                # else:
                #     collision_message = (
                #         "げっそーにやられました！\n"
                #         "どちらのタイプか不明ですが、足場を活用して回避するのが重要です。\n"
                #         "5秒前に戻って、安全な場所を探しながら進んでみましょう。"
                #     )
                collision_message = (
                         "げっそーにやられました！\n"
                         "どちらのタイプか不明ですが、足場を活用して回避するのが重要です。\n"
                         "5秒前に戻って、安全な場所を探しながら進んでみましょう。"
                     )

            # パックンフラワーに近づきすぎた場合
            elif 'P Flower' in label:
                if 'Fire Mario' in mario_state['state']:  # ファイヤーマリオが有効な場合
                    collision_message = (
                        "パックンフラワーに近づきすぎて死亡しました！\n"
                        "ファイヤーマリオなら、ファイアボールでパックンフラワーを倒せます。\n"
                        "安全に進むために、5秒前に戻って再挑戦してみましょう。"
                    )
                else:
                    collision_message = (
                        "パックンフラワーぶつかって死亡しました！\n"
                        "パックンフラワーは出てくるタイミングを見計らって進む必要があります。\n"
                        "土管の近くに立っていれば出てこなくなるので、一旦待ってみましょう。では5秒前に戻って慎重に進んでみましょう。"
                    )

            # トゲゾーにぶつかった場合
            elif 'Togezo' in label:
                if mario_state['y'] < environment['y']:  # 空中に足場がある場合
                    collision_message = (
                        "トゲゾーにぶつかって死亡しました！\n"
                        "トゲゾーが空から降りてきた場合、周りの足場を確認してみましょう。\n"
                        "上に足場がある場合は、そこに一時避難してから進みましょう。5秒前に戻って再挑戦！"
                    )
                else:  # 地面の足場がある場合
                    collision_message = (
                        "トゲゾーにぶつかって死亡しました！\n"
                        "トゲゾーは、タイミングを見計らって避けることが大切です。\n"
                        "周囲に穴があればうまいこと、そこに落として見ましょう。5秒前に戻って再挑戦！"
                    )

            # エレベーターで死亡した場合
            elif 'Elevator' in label:
                collision_message = (
                    "エレベーターで死亡しました！\n"
                    "エレベーターは不安定な足場なので、急がず落ち着いて移動しましょう。\n"
                    "周りの足場を利用して、足元に気をつけて進んでください。5秒前に戻って再挑戦！"
                )

            # ノコノコに遭遇した場合
            elif 'Nokonoko' in label:
                if 'Fire Mario' in mario_state['state']:  # ファイヤーマリオなら
                    collision_message = (
                        "ノコノコにぶつかって死亡しました！\n"
                        "ファイヤーマリオなら、ノコノコを倒すためにファイアボールを使うことができます。\n"
                        "5秒前に戻って、ファイアボールを使って進みましょう！"
                    )
                else:
                    collision_message = (
                        "ノコノコにぶつかって死亡しました！\n"
                        "ノコノコはジャンプで踏みつけて倒せます。\n"
                        "また、甲羅を利用して遠くの敵を倒すことができます。5秒前に戻って再挑戦！"
                    )
            
            # パタパタに遭遇した場合
            elif 'Patapata' in label:
                if 'Fire Mario' in mario_state['state'] :  # ファイヤーマリオなら
                    collision_message = (
                        "パタパタにぶつかって死亡しました！\n"
                        "ファイヤーマリオなら、パタパタを倒すためにファイアボールを使うことができます。\n"
                        "5秒前に戻って、ファイアボールを使って進みましょう！"
                    )
                else:
                    collision_message = (
                        "パタパタにぶつかって死亡しました！\n"
                        "パタパタは難しいですが、タイミングをよく見てジャンプで踏みつけて倒せます。\n"
                        "また、その甲羅を利用して遠くの敵を倒すことができます。5秒前に戻って再挑戦！"
                    )
            
            # パタパタに遭遇した場合
            elif 'Met' in label:
                if 'Fire Mario' in mario_state['state'] :  # ファイヤーマリオなら
                    collision_message = (
                        "パタパタにぶつかって死亡しました！\n"
                        "メットはファイヤーマリオの火を防ぎます。\n"
                        "倒す方法は踏みつけることです！動きが遅いので避けてみるのもいいかもしれません。５秒前に戻って再挑戦！"
                    )
                else:
                    collision_message = (
                        "パタパタにぶつかって死亡しました！\n"
                        "パタパタは難しいですが、タイミングをよく見てジャンプで踏みつけて倒せます。\n"
                        "また、その甲羅を利用して遠くの敵を倒すことができます。5秒前に戻って再挑戦！"
                    )

            # クッパにぶつかった場合
            elif 'Kuppa' in label:
                if 'Fire Mario' in mario_state['state'] and 'Big Mario' in mario_state['state']:  # ファイヤーマリオかつビッグマリオ
                    if mario_state['y'] < environment["y"]:  # マリオのy座標が足場より高い場合
                        collision_message = (
                            "クッパに倒されました！\n"
                            "足場などを使ってクッパの攻撃をかわすことができます。5秒前に戻って再挑戦しましょう！"
                        )
                    else:
                        collision_message = (
                            "クッパに倒されました！\n"
                            "今の状態ならば、クッパにぶつかってみても一瞬無敵になれます。\n"
                            "5秒前に戻って再挑戦してみましょう！"
                        )
                else:
                    collision_message = (
                        "クッパに倒されました！\n"
                        "クッパの攻撃を避けるためには、タイミングを見計らってジャンプし、または周囲の足場を利用して攻撃をかわしましょう。\n"
                        "5秒前に戻って慎重に進んでください！"
                    )

            elif hatena_block_time is not None and current_time - hatena_block_time <= 10:
                if 'Big Mario' not in mario_state['code'] and 'Fire Mario' not in mario_state['code']:
                    collision_message += (
                        "ちなみに10秒以内はてなブロックがありました、\n"
                        "今の状態で叩いてフラワーが入っていればファイヤーマリオに変身して、火を出せます。\n"
                        "10秒前に戻って、ブロックを取りに行きましょう！"
                    )